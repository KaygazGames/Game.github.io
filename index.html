<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Futbol Oyunu - Multiplayer</title>
  <style>
    body { margin: 0; padding: 0; background: #222; }
    canvas { background: #006400; display: block; margin: auto; }
  </style>
  <!-- Firebase App (Temel Firebase SDK'sı) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <!-- Firebase Realtime Database -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    // 1. Firebase Konfigürasyonu (Kendi projenizden alınan bilgileri buraya ekleyin)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Firebase'i başlat
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // 2. Oyuncu Oluşturma: Her tarayıcı için benzersiz bir ID oluşturuluyor.
    const playerId = 'player-' + Math.floor(Math.random() * 1000000);
    let player = {
      id: playerId,
      x: 400, // canvas genişliğinin yarısı
      y: 300, // canvas yüksekliğinin yarısı
      color: '#' + Math.floor(Math.random()*16777215).toString(16)
    };

    // Tüm oyuncuları tutacak obje
    const players = {};

    // 3. Oyuncu konumunu Firebase'e gönderme
    function updatePlayerPosition() {
      database.ref('players/' + player.id).set(player);
    }

    // Tarayıcı kapandığında oyuncuyu sil
    database.ref('players/' + player.id).onDisconnect().remove();

    // 4. Firebase'den oyuncu verilerini dinleme
    database.ref('players').on('value', (snapshot) => {
      const data = snapshot.val() || {};
      // Tüm oyuncu verilerini güncelle
      for (let id in data) {
        players[id] = data[id];
      }
      // Firebase'de olmayan oyuncuları kaldır
      for (let id in players) {
        if (!data[id]) {
          delete players[id];
        }
      }
    });

    // 5. Tuş dinleyicisi ile oyuncu hareketleri (ok tuşları)
    document.addEventListener('keydown', (event) => {
      const speed = 5;
      if (event.key === 'ArrowUp') player.y -= speed;
      if (event.key === 'ArrowDown') player.y += speed;
      if (event.key === 'ArrowLeft') player.x -= speed;
      if (event.key === 'ArrowRight') player.x += speed;
      
      // Oyuncunun canvas sınırları içinde kalmasını sağla
      player.x = Math.max(15, Math.min(canvas.width - 15, player.x));
      player.y = Math.max(15, Math.min(canvas.height - 15, player.y));
      updatePlayerPosition();
    });

    // 6. Canvas ve oyun döngüsü
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Örnek: Ortadaki çizgiyi çiz
      ctx.strokeStyle = 'white';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(canvas.width / 2, 0);
      ctx.lineTo(canvas.width / 2, canvas.height);
      ctx.stroke();

      // Tüm oyuncuları çiz
      for (let id in players) {
        const p = players[id];
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 15, 0, 2 * Math.PI);
        ctx.fill();
        // Oyuncu adını çiz
        ctx.fillStyle = 'white';
        ctx.font = '12px Arial';
        ctx.fillText(id, p.x - 20, p.y - 20);
      }

      requestAnimationFrame(gameLoop);
    }
    gameLoop();

    // İlk konum güncellemesini yap
    updatePlayerPosition();
  </script>
</body>
</html>
