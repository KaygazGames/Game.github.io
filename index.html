<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Banka ve Hacker Simülatörü</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .hidden { display: none; }
    input, button { padding: 10px; margin: 5px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background-color: #333; color: white; }
  </style>
</head>
<body>

  <h1>Banka & Hacker Simülatörü</h1>

  <!-- Giriş / Kayıt -->
  <div id="auth-section">
    <h2>Giriş Yap</h2>
    <input type="text" id="username" placeholder="Kullanıcı Adı">
    <input type="password" id="password" placeholder="Şifre">
    <button onclick="login()">Giriş Yap</button>
    <div id="loginMessage"></div>
  </div>

  <!-- Oyunun Ana Bölümü -->
  <div id="game-section" class="hidden">
    <h2>Hoş geldin, <span id="currentUser"></span></h2>
    <p>Bakiye: <strong>$<span id="balance"></span></strong></p>

    <h3>Kullanıcılar:</h3>
    <table>
      <thead>
        <tr>
          <th>Kullanıcı Adı</th>
          <th>Bakiye</th>
          <th>Hackle</th>
        </tr>
      </thead>
      <tbody id="userTable"></tbody>
    </table>
  </div>

  <script>
    let users = [];
    let currentUser = null;

    async function fetchData() {
      try {
        const response = await fetch('data.json');
        users = await response.json();
        console.log("Kullanıcılar yüklendi:", users);
      } catch (error) {
        console.error("Veri yüklenemedi:", error);
      }
    }

    function login() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();

      currentUser = users.find(user => user.username === username && user.password === password);
      if (currentUser) {
        document.getElementById('auth-section').classList.add('hidden');
        document.getElementById('game-section').classList.remove('hidden');
        document.getElementById('currentUser').textContent = currentUser.username;
        document.getElementById('balance').textContent = currentUser.balance;
        renderUsers();
      } else {
        document.getElementById('loginMessage').textContent = 'Geçersiz kullanıcı adı veya şifre!';
      }
    }

    function renderUsers() {
      const table = document.getElementById('userTable');
      table.innerHTML = '';

      users.forEach(user => {
        if (user.username !== currentUser.username) {
          table.innerHTML += `
            <tr>
              <td>${user.username}</td>
              <td>$${user.balance}</td>
              <td><button onclick="hack('${user.username}')">Hackle (100$)</button></td>
            </tr>
          `;
        }
      });
    }

    function hack(targetUsername) {
      const targetUser = users.find(user => user.username === targetUsername);
      if (currentUser.balance < 100) {
        alert('Yetersiz bakiye!');
        return;
      }
      currentUser.balance -= 100; // Hackleme ücreti
      if (Math.random() < 0.5) { // %50 başarı
        targetUser.balance -= 100;
        currentUser.balance += 100;
        alert(`${targetUsername} başarıyla hacklendi!`);
      } else {
        alert('Hackleme başarısız!');
      }
      document.getElementById('balance').textContent = currentUser.balance;
      renderUsers();
      saveData();
    }

    async function saveData() {
      console.log("Güncellenmiş veriler:", users);
      alert('Veriler güncellenmiştir! (Not: GitHub Pages canlı olarak verileri güncelleyemez.)');
    }

    fetchData();
  </script>

</body>
</html>
